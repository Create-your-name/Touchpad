# Jazz

## 硬件和环境：

* STM32F103ZET6 

  这个无所谓，只是用到了按键检测和串口通信，其他有以上两个功能的单片机都可以。需要注意的是我的32是用Arduino IDE开发的，比较方便。

* Mac版本12.3.1

  目前不清楚系统版本对效果的影响，不同的版本应该没啥问题。

* 电路板：

  嘉立创0元购（5套） + 40元的元器件（10套）

  

## 简单说一下原理：

电路板的作用就是检测有无手指按下，本质上就是四个按键检测，按下哪个按键就通过串口向电脑发送对应的序号，当检测到300ms不再有新的按键按下时，单片机向电脑发送一个b'o'作为结束。

Mac端的python代码分为2个线程，线程之间的数据通过加互斥锁的字典传递（这个信息就是摄像头检测的人脸朝向），线程1是一个不断检测人脸朝向的代码，会实时将人脸的朝向写入上面提到的字典里。线程2是串口接收，串口的接收缓冲区大小是1，当接收到o的时候判断动作是左右滑动，外加从字典里查看当前人脸朝向，然后做出相应的动作。

python控制电脑的本质就是模拟电脑按下快捷键，这里切换工作区的快捷键我分别设置成ctrl+o和ctrl+i。因为不同屏幕切换工作区的时候鼠标要在对应的屏幕上，所以这里检测头朝向其实控制的是鼠标出现在哪个屏幕上，然后根据对应的滑动动作让对应的屏幕做出相应的动作。

## 说明

PCB我不知道怎么开源，但是我画板子的时候主要参考的就是这个，就是我的布局看起来比他的更紧凑一下，但是事实证明紧凑并不是很好，容易一下子按两个了，所以我觉得这位大哥的板子挺不错的，大家可以直接打他的（立创EDA免费打板现在需要领券） https://oshwhub.com/irongu/BS814A-1chu-mo-an-jian-mu-kuai

怎么让代码运行在后台：

打开终端，首先使用 screen -S jazz 命令创建一个新的screen，然后运行python main.py运行代码之后关闭终端即可。













